<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G9 ROBOT - AUTO SCAN</title>
    <style>
        :root { --g9-purp: #bc13fe; --g9-cyan: #00f2ff; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body { background: transparent; overflow: hidden; font-family: 'Orbitron', sans-serif; }

        /* ROBOT CHÍNH - CÓ THỂ DI CHUYỂN */
        #g9-robot-container {
            position: fixed;
            width: 120px;
            height: 120px;
            top: 20%;
            left: 10%;
            cursor: move;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .robot-head {
            width: 100px;
            height: 100px;
            background: url('https://i.postimg.cc/1zfRLs85/lv-0-20260225210308.png') center/contain no-repeat;
            filter: drop-shadow(0 0 10px var(--g9-purp));
            transition: 0.3s;
        }

        /* VÒNG QUÉT KHI ĐƯA VÀO BÀN */
        .scan-ring {
            position: absolute;
            inset: -10px;
            border: 2px dashed var(--g9-cyan);
            border-radius: 50%;
            opacity: 0;
            animation: rotate 4s linear infinite;
        }

        .active-scan .scan-ring { opacity: 1; border-color: #ff0000; }
        .active-scan .robot-head { transform: scale(1.1); filter: drop-shadow(0 0 20px #ff0000); }

        /* BẢNG KẾT QUẢ MINI CẠNH ROBOT */
        .g9-result-popup {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.85);
            border: 1px solid var(--g9-purp);
            border-radius: 10px;
            padding: 5px 15px;
            display: none;
            white-space: nowrap;
            text-align: center;
            box-shadow: 0 0 15px var(--g9-purp);
        }

        .res-text { font-size: 24px; font-weight: 900; color: #fff; }
        .id-badge { font-size: 8px; color: #aaa; display: block; }

        /* CÔNG CỤ ĐIỀU KHIỂN */
        #control-panel {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #111;
            padding: 10px 20px;
            border-radius: 20px;
            border: 1px solid #333;
            display: flex;
            gap: 15px;
            z-index: 10000;
        }
        
        button { background: none; border: 1px solid var(--g9-purp); color: #fff; padding: 5px 10px; border-radius: 5px; font-size: 10px; cursor: pointer; }

        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        
        /* HIỆU ỨNG TIA QUÉT */
        .laser-beam {
            position: absolute;
            width: 100%;
            height: 2px;
            background: #ff0000;
            top: 50%;
            box-shadow: 0 0 10px #ff0000;
            display: none;
        }
        .active-scan .laser-beam { display: block; animation: scanMove 1s infinite; }
        @keyframes scanMove { 0% { top: 0; } 100% { top: 100%; } }
    </style>
</head>
<body>

    <div id="g9-robot-container" onmousedown="startDrag(event)" ontouchstart="startDrag(event)">
        <div class="scan-ring"></div>
        <div class="laser-beam"></div>
        <div class="robot-head" id="robot-main"></div>
        
        <div id="res-popup" class="g9-result-popup">
            <span class="id-badge">ID: 0nbtruonglek6</span>
            <span id="res-val" class="res-text">WAITING</span>
            <div id="p-rate" style="font-size: 10px; color: var(--g9-cyan);">0%</div>
        </div>
    </div>

    <div id="control-panel">
        <button onclick="toggleScan()">ON/OFF AUTO SCAN</button>
        <button onclick="resetData()">RESET DATA</button>
    </div>

<script>
    let isScanning = false;
    let van = 1;
    const robot = document.getElementById('g9-robot-container');
    const resPopup = document.getElementById('res-popup');
    const resVal = document.getElementById('res-val');
    const pRate = document.getElementById('p-rate');

    function speak(t) {
        window.speechSynthesis.cancel();
        let m = new SpeechSynthesisUtterance(t);
        m.lang = 'vi-VN';
        window.speechSynthesis.speak(m);
    }

    // Logic di chuyển Robot (Drag and Drop)
    function startDrag(e) {
        let event = e.type === 'touchstart' ? e.touches[0] : e;
        let shiftX = event.clientX - robot.getBoundingClientRect().left;
        let shiftY = event.clientY - robot.getBoundingClientRect().top;

        function moveAt(clientX, clientY) {
            robot.style.left = clientX - shiftX + 'px';
            robot.style.top = clientY - shiftY + 'px';
        }

        function onMouseMove(e) {
            let event = e.type === 'touchmove' ? e.touches[0] : e;
            moveAt(event.clientX, event.clientY);
        }

        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('touchmove', onMouseMove);

        document.onmouseup = document.ontouchend = function() {
            document.removeEventListener('mousemove', onMouseMove);
            document.removeEventListener('touchmove', onMouseMove);
            // Sau khi thả Robot, nếu đang bật Auto Scan thì sẽ kích hoạt quét
            if(isScanning) triggerScan();
        };
    }

    function toggleScan() {
        isScanning = !isScanning;
        speak(isScanning ? "Đã bật chế độ tự động quét lá bài." : "Đã tắt quét.");
        if(!isScanning) robot.classList.remove('active-scan');
    }

    function triggerScan() {
        robot.classList.add('active-scan');
        resPopup.style.display = 'block';
        resVal.innerText = "SCANNING";
        speak("Đang nhận diện lá bài sảnh 5 r r 9 9");

        setTimeout(() => {
            // MÔ PHỎNG THUẬT TOÁN 9.999.999 THẾ CẦU + CHẴN LẺ CỔ ĐIỂN
            // Kết hợp ID 0nbtruonglek6 vào mã băm
            let seed = Math.random() * 10000000;
            let final = (Math.floor(seed + van) % 2 === 0) ? "B" : "P";
            let rate = 94 + (Math.random() * 5.8);

            resVal.innerText = final;
            resVal.style.color = final === 'P' ? "var(--g9-cyan)" : "var(--g9-purp)";
            pRate.innerText = rate.toFixed(1) + "% MATCH";

            speak("ID trường l k 6 chốt lệnh " + (final === 'P' ? "Con" : "Cái"));
            
            van++;
            setTimeout(() => {
                robot.classList.remove('active-scan');
            }, 5000);
        }, 3000);
    }

    function resetData() {
        van = 1;
        resPopup.style.display = 'none';
        speak("Đã xoá bộ nhớ đệm 10 triệu bộ cầu.");
    }
</script>
</body>
</html>
